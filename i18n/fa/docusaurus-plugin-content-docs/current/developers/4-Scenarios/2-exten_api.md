---

sidebar_label: "سناریو Exten API"
title: "سناریو Exten API"
---


# Exten API

:::tip توصیه
پیشنهاد می‌شود قبل از مطالعه این مطلب، ابتدا [اینجا](../SimotelWebhooks/DialplanApiComponents/exten_api/) را بررسی فرمایید.
:::

فرض کنید نیاز می‌باشد زمانی که مشتری با مجموعه شما تماس گرفت اگر آن مشتری طی ۲۴ ساعت گذشته با  مجموعه شما تماس داشته و با یکی از کارمندان 
مجموعه در ارتباط بوده است، حال نیز سیستم تماس جاری مشتری را به همان کارمند متصل بکند و مستقیما تلفن او زنگ بخورد.

برای پیاده سازی این سناریو کافیست از کامپوننت Exten API استفاده کرد، زمانی که تماسی وارد سیستم شد مستقیما به Exten API متصل می‌شود، در اینجا
اطلاعات تماس گیرنده به سمت وب‌ سرویس شما ارسال می‌شوند که شامل

```shell
{
  "src": "09155441",
  "dst": "31041000",
  "data": "",
  "unique_id": "",
  "app_name": "Extension API"
}
```
در این مثال شماره مبداء 09155441  با مجموعه تماس گرفته است، حال نیاز است با استفاده از داده‌های دریافتی از رویداد`New State` به این نتیجه
برسیم که آیا طی ۲۴ساعت گذشته تماسی از این شماره توسط داخلی پاسخ‌داده شده است یا خیر، برای مثال در این سناریو داخلی 200 در روز گذشته به تماس این
شماره پاسخ داده است بنابراین نیاز می‌باشد وب‌ سرویس در جواب خروجی زیر را به سمت Exten API ارسال کند.

```shell
{
  "ok": "1",
  "extension": "200"
}
```

در این مرحله تماس به داخلی 200 متصل شده و تلفن داخلی 200 شروع به زنگ خوردن می‌کند، برای کسب اطلاعات بیشتر درمورد رویداد `New State` [اینجا](../SimotelWebhooks/Events/new_state/) مراجعه فرمایید.

**سناریوی پیاده‌سازی شده در دایل‌پلن**

<a href='https://dialplan.mysup.ir/live/plan/gmcnmdul9rpb79j7ufs8jlybn857qth81y0hi02m5rhfmbma2f' target='_blank'><img src='https://dialplan.mysup.ir/live/thumb/gmcnmdul9rpb79j7ufs8jlybn857qth81y0hi02m5rhfmbma2f/plan.png' /></a>